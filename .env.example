# Application
APP_NAME="OPBX - Open Source Business PBX"
APP_ENV=production
APP_KEY=
APP_DEBUG=false
APP_URL=http://localhost
APP_PORT=80

APP_LOCALE=en
APP_FALLBACK_LOCALE=en
APP_FAKER_LOCALE=en_US

BCRYPT_ROUNDS=12

# Logging
LOG_CHANNEL=stack
LOG_STACK=single
LOG_DEPRECATIONS_CHANNEL=null
LOG_LEVEL=info

# Database
# SECURITY WARNING: Generate strong random passwords!
# Use: openssl rand -base64 32
# Or: php artisan generate:password
DB_CONNECTION=mysql
DB_HOST=mysql
DB_PORT=3306
DB_DATABASE=opbx
DB_USERNAME=opbx
DB_PASSWORD=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
DB_ROOT_PASSWORD=CHANGE_ME_GENERATE_32_CHAR_PASSWORD

# Session
SESSION_DRIVER=redis
SESSION_LIFETIME=120
SESSION_ENCRYPT=false
SESSION_PATH=/
SESSION_DOMAIN=null

# Laravel Sanctum
SANCTUM_STATEFUL_DOMAINS=localhost:3000,127.0.0.1:3000
SANCTUM_EXPIRATION=1440

# Broadcasting
BROADCAST_DRIVER=pusher
BROADCAST_CONNECTION=default

# WebSocket / Soketi Configuration
# SECURITY WARNING: Generate strong random secrets!
# Use: openssl rand -base64 64
PUSHER_APP_ID=app-id
PUSHER_APP_KEY=pbxappkey
PUSHER_APP_SECRET=CHANGE_ME_GENERATE_64_CHAR_SECRET
PUSHER_HOST=soketi
PUSHER_PORT=6001
PUSHER_SCHEME=http
PUSHER_APP_CLUSTER=mt1
SOKETI_PORT=6001
SOKETI_METRICS_PORT=9601
SOKETI_DEBUG=0

# Filesystem
FILESYSTEM_DISK=local

# MinIO Object Storage Configuration
# MinIO is used for storing recordings and other files
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_REGION=us-east-1
MINIO_BUCKET=recordings
MINIO_ENDPOINT=http://minio:9000
MINIO_USE_PATH_STYLE=true

# Queue
QUEUE_CONNECTION=redis

# Cache
CACHE_STORE=redis

# Redis
# SECURITY WARNING: Always set a Redis password for production!
# Use: openssl rand -base64 32
REDIS_CLIENT=phpredis
REDIS_HOST=redis
REDIS_PASSWORD=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
REDIS_PORT=6379

# Redis External Port Exposure (SECURITY: Leave empty for production)
# Only expose Redis port if absolutely necessary for external debugging
# Set to "6379" to expose externally, leave empty to keep internal only
REDIS_EXPOSE_PORT=

# Mail (optional)
MAIL_MAILER=smtp
MAIL_HOST=mailpit
MAIL_PORT=1025
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS="noreply@opbx.local"
MAIL_FROM_NAME="${APP_NAME}"

# Cloudonix CPaaS Configuration
# Get your API token from https://developers.cloudonix.com
CLOUDONIX_API_URL=https://api.cloudonix.io
CLOUDONIX_API_TOKEN=
CLOUDONIX_API_TIMEOUT=30

# Voice Webhook Authentication
# Token that Cloudonix will send in Authorization header for voice routing webhooks
# SECURITY WARNING: Generate a strong random token!
# Use: openssl rand -base64 64
VOICE_WEBHOOK_TOKEN=CHANGE_ME_GENERATE_64_CHAR_SECRET

# Webhook Security Configuration
# IMPORTANT: Set a secure webhook secret (minimum 32 characters)
# This is used to verify webhook signatures using HMAC-SHA256
# SECURITY WARNING: Generate a strong random secret!
# Use: openssl rand -base64 64
CLOUDONIX_WEBHOOK_SECRET=CHANGE_ME_GENERATE_64_CHAR_SECRET
CLOUDONIX_VERIFY_SIGNATURE=true
CLOUDONIX_IDEMPOTENCY_TTL=86400

# Note: CDR webhook authentication is configured per-organization via CloudonixSettings
# Set domain_cdr_auth_key in Organization Settings UI

# Webhook Configuration
# Public URL where Cloudonix can reach your webhooks
# For local development, use ngrok (tunnel service runs in Docker)
WEBHOOK_BASE_URL=https://your-domain.com

# ngrok Configuration
# Get your authtoken from https://dashboard.ngrok.com/get-started/your-authtoken
NGROK_AUTHTOKEN=

# Idempotency TTL in seconds (24 hours default)
WEBHOOK_IDEMPOTENCY_TTL=86400
# Maximum response size to cache (100KB default)
WEBHOOK_MAX_CACHE_SIZE=102400
# Maximum webhook age for replay protection (5 minutes default)
WEBHOOK_REPLAY_MAX_AGE=300

# Rate Limiting Configuration
# Requests per minute for each endpoint type
RATE_LIMIT_API=60
RATE_LIMIT_WEBHOOKS=100
RATE_LIMIT_VOICE=1000
RATE_LIMIT_SENSITIVE=10
RATE_LIMIT_AUTH=5

# Call State Configuration
CALL_LOCK_TIMEOUT=30
CALL_STATE_TTL=3600

# CXML Configuration
CXML_DEFAULT_TIMEOUT=30
CXML_DEFAULT_VOICE=en-US-Standard-A

# Security Headers Configuration
# Content Security Policy (CSP) Configuration
# CSP Violation Reporting Endpoint (null to disable)
CSP_REPORT_URI=
# Additional domains allowed for AJAX/fetch (comma-separated, Cloudonix API auto-included)
CSP_CONNECT_DOMAINS=
# HSTS Configuration
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=false

# Frontend Configuration
FRONTEND_PORT=3000
FRONTEND_URL=http://localhost:3000

# Frontend Environment Variables (for React/Vite)
VITE_APP_NAME="${APP_NAME}"
VITE_API_BASE_URL=http://localhost/api/v1
VITE_WEBSOCKET_HOST=localhost
VITE_WEBSOCKET_PORT="${SOKETI_PORT}"
VITE_WEBSOCKET_KEY="${PUSHER_APP_KEY}"
VITE_WEBSOCKET_CLUSTER=mt1
